\documentclass[11pt]{article}
%\usepackage[framemethod=tikz]{mdframed}
\usepackage{tcolorbox}
\usepackage{titling}
\usepackage[os=win]{menukeys}
\newcommand{\numpy}{{\tt numpy}}    % tt font for numpy

\topmargin -.5in
\textheight 9in
\oddsidemargin -.25in
\evensidemargin -.25in
\textwidth 7in

\pretitle{%
  \begin{center}
  \LARGE
  \includegraphics[width=15cm]{../images/logo.png}\\[\bigskipamount]
}
\posttitle{\end{center}}

\begin{document}

% ========== Edit your name here
\author{Dr. Neil Eliot / Dr. Alun Moon}
\title{KF5004\\------\\Workshop 6\\------\\Setting up \texttt{Secondary DNS} servers and \texttt{DNS} Logging\\------}
\date{September 2019}
\maketitle

\newpage

% \begin{center}
%     \noindent\rule{8cm}{0.4pt}
% \end{center}

% ========== Introduction

\noindent\textbf{Learning Outcomes:}
\begin{itemize}
    \item Configure \texttt{BIND9} as a \texttt{secondary DNS}.
    \item Identify the network activity generated by a \texttt{Secondary Servers}.
    \item Configure \texttt{DNS} Logging.
\end{itemize}

% \begin{center}
% \noindent\rule{8cm}{0.4pt}
% \end{center}

\begin{tcolorbox}[title={\textbf{Important:}}]
    Before you begin, ensure the lab. \texttt{PC} you are using is connected to the off campus lab infrastructure and the machine receives an \texttt{IP} address from the lab. \texttt{DHCP} Server.
\end{tcolorbox}
\newpage

\noindent\textbf{The Exercise}\\
\begin{tcolorbox}[colback=blue!20]
    \noindent\textbf{From the commands and processes defined in the lecture carry out the following:}
\end{tcolorbox}

% ========== Begin answering questions here

\begin{tcolorbox}[title={\textbf{NOTE:}}]
    In this workshop you should use your virtual \texttt{Ubuntu Desktop} that you create in the first workshop. \textbf{Please do not alter the base machines in the laboratory}.
\end{tcolorbox}

\begin{enumerate}
    \item Create a new \texttt{Virtual Machine} and carry out a basic install. (Choose which ever technique you prefer)
        \begin{itemize}
            \item Create a machine from scratch.
            \item Copy the basic server create in the last session.
            \item Use the pre-created image from the \texttt{NAS} drive.
        \end{itemize}
        \begin{tcolorbox}[title={\textbf{NOTE:}}]
            A \texttt{DNS} Server should always have a static \texttt{IP} Address so once the machine has booted ensure you use one of your reserved \texttt{IP} Addresses.
        \end{tcolorbox}
    \item Install \texttt{BIND9} on the server via a remote connection. 
        \begin{tcolorbox}[title={\textbf{NOTE:}}]
            Make sure you install both \texttt{bind9} and \texttt{dnsutils}. 
        \end{tcolorbox}
    \item Configure the server to support a forward lookup \texttt{zone} for \texttt{student.co.uk zone} and a \texttt{rDNS} zone for the \texttt{www} and \texttt{mail} server addresses below. 
        \begin{itemize}
            \item All \texttt{IP} addresses are in the range \texttt{192.168.0.0/16} (\texttt{Class B})
            \begin{itemize}
                \item \texttt{192.168.100.2} $\Leftrightarrow$ \texttt{www2.student.co.uk}
                \item \texttt{192.168.100.2} $\Leftrightarrow$ \texttt{www.student.co.uk}
                \item \texttt{<your client IP>} $\Leftrightarrow$ \texttt{me.student.co.uk}
                \item \texttt{192.168.100.21} $\Leftrightarrow$ \texttt{server.student.co.uk}
                \item \texttt{192.168.100.2} $\Leftrightarrow$ \texttt{mail.student.co.uk}
                \item \texttt{192.168.100.254} $\Leftrightarrow$ \texttt{gateway.student.co.uk}
            \end{itemize}
        \end{itemize}
    \item Test your \texttt{zone} file has no errors.
    \item \label{itm:queries} Test the following queries:
        \begin{itemize}
            \item \texttt{192.168.100.2}
            \item \texttt{www.student.co.uk}
        \end{itemize}
    \item Create two further servers (as always you have options as above).
        \begin{tcolorbox}[title={\textbf{NOTE:}}]
            \noindent Don't forget. These are servers and \textbf{SHOULD} have static addresses. Use \texttt{IP} addresses from your provided range.
        \end{tcolorbox}
        \noindent The following operations apply to both of the new servers:
        \begin{itemize}
            \item Install \texttt{bind9} and \texttt{dnsutils} onto both of the new servers.
            \item Configure the two new servers to be \texttt{secondary DNS} servers for the \texttt{student.co.uk} zone.
            \item Test the secondary severs using the queries form \ref{itm:queries}
        \end{itemize}
    \item Set up \texttt{DNS} logging using the filename \texttt{/var/log/query.log} on \textbf{ALL} the servers.
        \begin{tcolorbox}[title={\textbf{NOTE:}}]
            \noindent Logging \textbf{should} be configured on \texttt{all} the servers so a full profile of activity can be established. Logging should only e used for short periods of tme as the log files can become very large. The logging file on the \texttt{primary DNS} allows you to identify if there are any rouge queries hitting the server.
        \end{tcolorbox}
        \begin{itemize}
            \item Re-run the preious queries (\ref{itm:queries}.) against each of the servers in the \texttt{DNS} infrastructure you have build and check the log files as you proceed.
        \end{itemize}
    \item Limit the access to your primary server to only allow the \texttt{secondary} servers to run queries.
    \item Block the \texttt{IP} address of your \texttt{Virtual Client} on one of your \texttt{secondary} servers and try running the queries again.
        \begin{itemize}
            \item Check the log files (\texttt{syslog} and \texttt{query.log}) to see the effect of blocking a client.
        \end{itemize}
\end{enumerate}    
END
\end{document}